pred=objres$pred
pred$x=pred$tp
pred$y=round(pred$fit,2)
tmp=data.frame(x=idf$tp,y=round(idf$Resp,2),color=idf$colorL,grp=idf$grp,Id=idf$Id)
ylim=pretty(seq(min(tmp$y),max(tmp$y),length.out = 7))
xlim=pretty(seq(min(tmp$x)*.9,max(tmp$x),length.out = 9))
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,])), name=i,type = "line",
color=unname(pred$color[which(pred$grp==i)][1]))
a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
tmp=data.frame(x=idf$tp,y=round(idf$Resp,2),color=idf$colorL,grp=idf$grp,Id=idf$Id)
ylim=pretty(seq(min(tmp$y),max(tmp$y),length.out = 7))
xlim=pretty(seq(min(tmp$x)*.9,max(tmp$x),length.out = 9))
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line-dotted",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,])), name=i,type = "line",
color=unname(pred$color[which(pred$grp==i)][1]))
a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
pred=objres$pred
pred$x=pred$tp
pred$y=round(pred$fit,2)
pred$ymax=round(pred$fit2pred$se.fit,2)
pred$ymin=round(pred$fit-pred$se.fit,2)
tmp=data.frame(x=idf$tp,y=round(idf$Resp,2),color=idf$colorL,grp=idf$grp,Id=idf$Id)
ylim=pretty(seq(min(tmp$y),max(tmp$y),length.out = 7))
xlim=pretty(seq(min(tmp$x)*.9,max(tmp$x),length.out = 9))
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,])), name=i,type = "line",
color=unname(pred$color[which(pred$grp==i)][1]))
a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a
tmp=data.frame(x=idf$tp,y=round(idf$Resp,2),color=idf$colorL,grp=idf$grp,Id=idf$Id)
ylim=pretty(seq(min(tmp$y),max(tmp$y),length.out = 7))
xlim=pretty(seq(min(tmp$x)*.9,max(tmp$x),length.out = 9))
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,])), name=i,type = "arearange",
color=unname(pred$color[which(pred$grp==i)][1]))
a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a
pred=objres$pred
pred$x=pred$tp
pred$y=round(pred$fit,2)
pred$ymax=round(pred$fit+pred$se.fit,2)
pred$ymin=round(pred$fit-pred$se.fit,2)
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,])), name=i,type = "arearange",
color=unname(pred$color[which(pred$grp==i)][1]))
a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,])), name=i,type = "arearange",
fillOpacity = 0.3,
lineWidth = 0,
color=unname(pred$color[which(pred$grp==i)][1]))
a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,])), name=i,type = "arearange",
fillOpacity = 0.3,
lineWidth = 0,zIndex = 0,
color=unname(pred$color[which(pred$grp==i)][1]))
a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,])), name=i,type = "arearange",
fillOpacity = 0.3,
lineWidth = 0,zIndex = 0,
color=unname(pred$color[which(pred$grp==i)][1]))
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a
pred
library(rCharts)
# year is converted to highcharts compatible datetime format
huron <- data.frame(
year = as.numeric(as.POSIXct(paste0(1875:1972, '-01-01')))*1000,
level = as.vector(LakeHuron)
)
# add ymin and ymax to data
dat <- transform(huron,
ymin = level - 1,
ymax = level + 1
)
h1 <- Highcharts$new()
h1$series(
data = toJSONArray2(dat[,c('year', 'level')], names = F, json = F),
zIndex = 1,
name = "Level"
)
h1$series(
data = toJSONArray2(dat[,c('year', 'ymin', 'ymax')], names = F, json = F),
type = 'arearange',
fillOpacity = 0.3,
lineWidth = 0,
color = 'lightblue',
zIndex = 0
)
h1$xAxis(type = 'datetime')
h1
toJSONArray2(dat[,c('year', 'ymin', 'ymax')], names = F, json = F)
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","ymin","ymax")])), name=i,type = "arearange",
fillOpacity = 0.3,
lineWidth = 0,
color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","ymin","ymax")])), name=i,type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
unname(pred$color[which(pred$grp==i)][1])
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","ymin","ymax")])), name=i,type = "arearange",
fillOpacity = 0.3,lineWidth = 0,zIndex = 0)
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
pred
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp))
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","ymin","ymax")])), name=i,type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
#   a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,type = "arearange",
#            fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","ymin","ymax")])),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
as.list(pred[j,c("x","ymin","ymax")])),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
h1 <- Highcharts$new()
h1$series(
data = toJSONArray2(dat[,c('year', 'level')], names = F, json = F),
zIndex = 1,
name = "Level"
)
h1$series(
data = toJSONArray2(dat[,c('year', 'ymin', 'ymax')], names = F, json = F),
type = 'arearange',
fillOpacity = 0.3,
lineWidth = 0,
color = 'lightblue',
zIndex = 0
)
h1$xAxis(type = 'datetime')
h1
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
as.list(pred[j,c("x","ymin","ymax")])),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
as.list(pred[j,c("x","ymin","ymax")])
j=1
as.list(pred[j,c("x","ymin","ymax")])
unname(as.list(pred[j,c("x","ymin","ymax")]))
a <- rCharts::Highcharts$new()
# for(i in unique(tmp$Id))
#   a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
#            color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
resp
objres=compMod(df,lgrps,"X.log")
idf=objres$data
idf=idf[!idf$out,]
tmp=data.frame(x=idf$tp,y=round(idf$Resp,2),color=idf$colorL,grp=idf$grp,Id=idf$Id)
ylim=pretty(seq(min(tmp$y),max(tmp$y),length.out = 7))
xlim=pretty(seq(min(tmp$x)*.9,max(tmp$x),length.out = 9))
pred=objres$pred
pred$x=pred$tp
pred$y=round(pred$fit,2)
pred$ymax=round(pred$fit+1.96*pred$se.fit,2)
pred$ymin=round(pred$fit-1.96*pred$se.fit,2)
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
myf<-function(x) exp(x)
tmp=data.frame(x=idf$tp,y=round(myf(idf$Resp),2),color=idf$colorL,grp=idf$grp,Id=idf$Id)
pred=objres$pred
pred$x=pred$tp
pred$y=round(myf(pred$fit),2)
pred$ymax=round(myf(pred$fit+1.96*pred$se.fit,2))
pred$ymin=round(myf(pred$fit-1.96*pred$se.fit,2))
ylim=pretty(seq(min(pred$ymin),max(pred$ymax),length.out = 7))
xlim=pretty(seq(min(tmp$x)*.9,max(tmp$x),length.out = 9))
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
myf
pred=objres$pred
pred$x=pred$tp
pred$y=round(myf(pred$fit),2)
pred$ymax=round(myf(pred$fit+1.96*pred$se.fit),2)
pred$ymin=round(myf(pred$fit-1.96*pred$se.fit),2)
ylim=pretty(seq(min(pred$ymin),max(pred$ymax),length.out = 7))
xlim=pretty(seq(min(tmp$x)*.9,max(tmp$x),length.out = 9))
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=NULL,type = "line",
color=tmp$color[which(tmp$Id==i)][1])
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1], showInLegend = FALSE)
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1], showInLegend = FALSE)
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange", showInLegend = FALSE,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1], showInLegend = FALSE)
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,type = "line",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange", showInLegend = FALSE,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1], showInLegend = FALSE, marker= list(enabled = FALSE))
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,type = "line",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange", showInLegend = FALSE,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a
#a$tooltip( formatter = "#! function() { return this.point.grp + ') at ' + this.point.x + ': ' + this.point.y ; } !#")
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Mice"))
a
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1], showInLegend = FALSE, marker= list(enabled = FALSE))
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,type = "line",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange", showInLegend = FALSE,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Treatment group"))
a
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1], showInLegend = FALSE, marker= list(enabled = FALSE))
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,type = "line",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",# showInLegend = FALSE,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Treatment group"))
a
(grepl("\\.log$",resp)
)
resp
source('~/Stats/Shiny/TumGrowth/long.R')
mod=compMod(df,lgrps,"X.log")
resp=mod$Resp
idf=mod$data
idf=idf[!idf$out,]
if(grepl("\\.log$",resp))myf<-function(x) exp(x) else myf<-function(x) x
tmp=data.frame(x=idf$tp,y=round(myf(idf$Resp),2),color=idf$colorL,grp=idf$grp,Id=idf$Id)
pred=mod$pred
pred$x=pred$tp
pred$y=round(myf(pred$fit),2)
pred$ymax=round(myf(pred$fit+1.96*pred$se.fit),2)
pred$ymin=round(myf(pred$fit-1.96*pred$se.fit),2)
ylim=pretty(seq(min(pred$ymin),max(pred$ymax),length.out = 7))
xlim=pretty(seq(min(tmp$x)*.9,max(tmp$x),length.out = 9))
a <- rCharts::Highcharts$new()
for(i in unique(tmp$Id))
a$series(data = lapply(which(tmp$Id==i),function(j) as.list(tmp[j,])), name=i,type = "line",
color=tmp$color[which(tmp$Id==i)][1], showInLegend = FALSE, marker= list(enabled = FALSE))
for(i in unique(pred$grp)){
a$series(data = lapply(which(pred$grp==i),function(j) as.list(pred[j,c("x","y")])), name=i,type = "line",
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 1)
a$series(data = lapply(which(pred$grp==i),function(j)
unname(as.list(pred[j,c("x","ymin","ymax")]))),type = "arearange",# showInLegend = FALSE,
fillOpacity = 0.3,lineWidth = 0,color=unname(pred$color[which(pred$grp==i)][1]),zIndex = 0)
}
a$yAxis(title = list(text = "Response"), min = min(ylim), max = max(ylim), tickInterval = diff(ylim)[1])
a$xAxis(title = list(text = "Time"), min =  min(xlim), max = max(xlim), tickInterval = diff(xlim)[1])
a$legend(verticalAlign = "right", align = "right", layout = "vertical", title = list(text = "Treatment group"))
a
shiny::runApp()
shiny::runApp()
